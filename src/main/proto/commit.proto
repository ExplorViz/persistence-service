syntax = "proto3";

option java_multiple_files = true;
option java_package = "net.explorviz.persistence.proto";
option java_outer_classname = "CommitProto";

import "google/protobuf/empty.proto";
import "google/protobuf/timestamp.proto";

service CommitService {
  rpc PersistCommit (CommitData) returns (google.protobuf.Empty) {}
}

message CommitData {
  string landscape_token = 1;
  string repository_name = 2;
  string commit_id = 3;
  string parent_commit_id = 4;
  google.protobuf.Timestamp author_date = 5;
  google.protobuf.Timestamp commit_date = 6;
  string branch_name = 7;
  repeated string tags = 8;

  // Git file metrics
  repeated FileIdentifier unchanged_files = 9;
  repeated FileIdentifier added_files = 10;
  repeated FileIdentifier modified_files = 11;
  repeated FileIdentifier deleted_files = 12;
}

message FileIdentifier {
  string file_hash = 1;

  // Path relative to root of repository
  string file_path = 2;
}
